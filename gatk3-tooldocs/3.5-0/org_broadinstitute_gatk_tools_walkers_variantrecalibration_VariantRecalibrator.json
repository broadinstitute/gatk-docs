{
  "summary": "Build a recalibration model to score variant quality for filtering purposes",
  "parallel": [
    {
      "arg": "-nt",
      "name": "TreeReducible",
      "link": "http://www.broadinstitute.org/gatk/guide/tooldocs/org_broadinstitute_gatk_engine_CommandLineGATK.html#-nt"
    }
  ],
  "activeregion": {},
  "partitiontype": "NONE",
  "walkertype": "LocusWalker",
  "arguments": [
    {
      "summary": "Additional raw input variants to be used in building the model",
      "name": "--aggregate",
      "synonyms": "-aggregate",
      "type": "List[RodBinding[VariantContext]]",
      "required": "no",
      "fulltext": "These additional calls should be unfiltered and annotated with the error covariates that are intended to be used for modeling.",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "\u003ca href\u003dhtsjdk_variant_bcf2_BCF2Codec.html\u003eBCF2\u003c/a\u003e, \u003ca href\u003dhtsjdk_variant_vcf_VCFCodec.html\u003eVCF\u003c/a\u003e, \u003ca href\u003dhtsjdk_variant_vcf_VCF3Codec.html\u003eVCF3\u003c/a\u003e",
      "kind": "optional_in",
      "options": []
    },
    {
      "summary": "LOD score cutoff for selecting bad variants",
      "name": "--badLodCutoff",
      "synonyms": "-badLodCutoff",
      "type": "double",
      "required": "no",
      "fulltext": "Variants scoring lower than this threshold will be used to build the Gaussian model of bad variants.",
      "defaultValue": "-5.0",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "The dirichlet parameter in the variational Bayes algorithm.",
      "name": "--dirichlet",
      "synonyms": "-dirichlet",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "0.001",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "If specified, the variant recalibrator will ignore all input filters. Useful to rerun the VQSR from a filtered output file.",
      "name": "--ignore_all_filters",
      "synonyms": "-ignoreAllFilters",
      "type": "boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "optional_flag",
      "options": []
    },
    {
      "summary": "If specified, the variant recalibrator will also use variants marked as filtered by the specified filter name in the input VCF file",
      "name": "--ignore_filter",
      "synonyms": "-ignoreFilter",
      "type": "List[String]",
      "required": "no",
      "fulltext": "For this to work properly, the -ignoreFilter argument should also be applied to the ApplyRecalibration command.",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "optional_param",
      "options": []
    },
    {
      "summary": "The raw input variants to be recalibrated",
      "name": "--input",
      "synonyms": "-input",
      "type": "List[RodBindingCollection[VariantContext]]",
      "required": "yes",
      "fulltext": "These calls should be unfiltered and annotated with the error covariates that are intended to be used for modeling.",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "required_in",
      "options": []
    },
    {
      "summary": "Max number of Gaussians for the positive model",
      "name": "--maxGaussians",
      "synonyms": "-mG",
      "type": "int",
      "required": "no",
      "fulltext": "This parameter determines the maximum number of Gaussians that should be used when building a positive model\n using the variational Bayes algorithm.",
      "defaultValue": "8",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "Maximum number of VBEM iterations",
      "name": "--maxIterations",
      "synonyms": "-mI",
      "type": "int",
      "required": "no",
      "fulltext": "This parameter determines the maximum number of VBEM iterations to be performed in the variational Bayes algorithm.\n The procedure will normally end when convergence is detected.",
      "defaultValue": "150",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "Max number of Gaussians for the negative model",
      "name": "--maxNegativeGaussians",
      "synonyms": "-mNG",
      "type": "int",
      "required": "no",
      "fulltext": "This parameter determines the maximum number of Gaussians that should be used when building a negative model\n using the variational Bayes algorithm. The actual maximum used is the smaller value between the mG and mNG\n arguments, meaning that if -mG is smaller than -mNG, -mG will be used for both. Note that this number should\n be small (e.g. 4) to achieve the best results.",
      "defaultValue": "2",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "Maximum number of training data",
      "name": "--maxNumTrainingData",
      "synonyms": "-maxNumTrainingData",
      "type": "int",
      "required": "no",
      "fulltext": "The number of variants to use in building the Gaussian mixture model. Training sets larger than this will be randomly downsampled.",
      "defaultValue": "2500000",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "Minimum number of bad variants",
      "name": "--minNumBadVariants",
      "synonyms": "-minNumBad",
      "type": "int",
      "required": "no",
      "fulltext": "This parameter determines the minimum number of variants that will be selected from the list of worst scoring\n variants to use for building the Gaussian mixture model of bad variants.",
      "defaultValue": "1000",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "Recalibration mode to employ",
      "name": "--mode",
      "synonyms": "-mode",
      "type": "Mode",
      "required": "yes",
      "fulltext": "Use either SNP for recalibrating only SNPs (emitting indels untouched in the output VCF) or INDEL for indels (emitting SNPs untouched in the output VCF).\n There is also a BOTH option for recalibrating both SNPs and indels simultaneously, but this is meant for testing purposes only and should not be used in actual analyses.",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "required_param",
      "options": [
        {
          "summary": "",
          "name": "SNP"
        },
        {
          "summary": "",
          "name": "INDEL"
        },
        {
          "summary": "",
          "name": "BOTH"
        }
      ]
    },
    {
      "summary": "Apply logit transform and jitter to MQ values",
      "name": "--MQCapForLogitJitterTransform",
      "synonyms": "-MQCap",
      "type": "int",
      "required": "no",
      "fulltext": "MQ is capped at a \"max\" value (60 for bwa-mem) when the alignment is considered perfect. Typically, a huge\n proportion of the reads in a dataset are perfectly mapped, which yields a distribution of MQ values with a\n blob below the max value and a huge peak at the max value. This does not conform to the expectations of the\n Gaussian mixture model of VQSR and has been observed to yield a ROC curve with a jump.\n\n This argument aims to mitigate this problem. Using MQCap \u003d X has 2 effects:  (1) MQs are transformed by a scaled\n logit on [0,X] (+ epsilon to avoid division by zero) to make the blob more Gaussian-like and (2) the transformed\n MQ\u003dX are jittered to break the peak into a narrow Gaussian.\n\n Beware that IndelRealigner, if used, adds 10 to MQ for successfully realigned indels. We recommend to either use\n --read-filter ReassignOriginalMQAfterIndelRealignment with HaplotypeCaller or use a MQCap\u003dmax+10 to take that\n into account.\n\n If this option is not used, or if MQCap is set to 0, MQ will not be transformed.",
      "defaultValue": "0",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "Number of k-means iterations",
      "name": "--numKMeans",
      "synonyms": "-nKM",
      "type": "int",
      "required": "no",
      "fulltext": "This parameter determines the number of k-means iterations to perform in order to initialize the means of\n the Gaussians in the Gaussian mixture model.",
      "defaultValue": "100",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "The number of prior counts to use in the variational Bayes algorithm.",
      "name": "--priorCounts",
      "synonyms": "-priorCounts",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "20.0",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "The output recal file used by ApplyRecalibration",
      "name": "--recal_file",
      "synonyms": "-recalFile",
      "type": "VariantContextWriter",
      "required": "yes",
      "fulltext": "",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "required_out",
      "options": []
    },
    {
      "summary": "A list of sites for which to apply a prior probability of being correct but which aren\u0027t used by the algorithm (training and truth sets are required to run)",
      "name": "--resource",
      "synonyms": "-resource",
      "type": "List[RodBinding[VariantContext]]",
      "required": "yes",
      "fulltext": "Any set of VCF files to use as lists of training, truth, or known sites.\n Training - The program builds the Gaussian mixture model using input variants that overlap with these training sites.\n Truth - The program uses these truth sites to determine where to set the cutoff in VQSLOD sensitivity.\n Known - The program only uses known sites for reporting purposes (to indicate whether variants are already known or novel). They are not used in any calculations by the algorithm itself.\n Bad - A database of known bad variants can be used to supplement the set of worst ranked variants (compared to the Gaussian mixture model) that the program selects from the data to model \"bad\" variants.",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "\u003ca href\u003dhtsjdk_variant_bcf2_BCF2Codec.html\u003eBCF2\u003c/a\u003e, \u003ca href\u003dhtsjdk_variant_vcf_VCFCodec.html\u003eVCF\u003c/a\u003e, \u003ca href\u003dhtsjdk_variant_vcf_VCF3Codec.html\u003eVCF3\u003c/a\u003e",
      "kind": "required_in",
      "options": []
    },
    {
      "summary": "The output rscript file generated by the VQSR to aid in visualization of the input data and learned model",
      "name": "--rscript_file",
      "synonyms": "-rscriptFile",
      "type": "File",
      "required": "no",
      "fulltext": "",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "optional_out",
      "options": []
    },
    {
      "summary": "The shrinkage parameter in the variational Bayes algorithm.",
      "name": "--shrinkage",
      "synonyms": "-shrinkage",
      "type": "double",
      "required": "no",
      "fulltext": "",
      "defaultValue": "1.0",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "Annotation value divergence threshold (number of standard deviations from the means) ",
      "name": "--stdThreshold",
      "synonyms": "-std",
      "type": "double",
      "required": "no",
      "fulltext": "If a variant has annotations more than -std standard deviations away from mean, it won\u0027t be used for building\n the Gaussian mixture model.",
      "defaultValue": "10.0",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_param",
      "options": []
    },
    {
      "summary": "The expected novel Ti/Tv ratio to use when calculating FDR tranches and for display on the optimization curve output figures. (approx 2.15 for whole genome experiments). ONLY USED FOR PLOTTING PURPOSES!",
      "name": "--target_titv",
      "synonyms": "-titv",
      "type": "double",
      "required": "no",
      "fulltext": "The expected transition / transversion ratio of true novel variants in your targeted region (whole genome, exome, specific\n genes), which varies greatly by the CpG and GC content of the region. See expected Ti/Tv ratios section of the GATK best\n practices documentation (http://www.broadinstitute.org/gatk/guide/best-practices) for more information.\n Normal values are 2.15 for human whole genome values and 3.2 for human whole exomes. Note\n that this parameter is used for display purposes only and isn\u0027t used anywhere in the algorithm!",
      "defaultValue": "2.15",
      "minValue": "-Infinity",
      "maxValue": "Infinity",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "optional_param",
      "options": []
    },
    {
      "summary": "The output tranches file used by ApplyRecalibration",
      "name": "--tranches_file",
      "synonyms": "-tranchesFile",
      "type": "File",
      "required": "yes",
      "fulltext": "",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "required_out",
      "options": []
    },
    {
      "summary": "Trust that all the input training sets\u0027 unfiltered records contain only polymorphic sites to drastically speed up the computation.",
      "name": "--trustAllPolymorphic",
      "synonyms": "-allPoly",
      "type": "Boolean",
      "required": "no",
      "fulltext": "",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "advanced_flag",
      "options": []
    },
    {
      "summary": "The levels of truth sensitivity at which to slice the data. (in percent, that is 1.0 for 1 percent)",
      "name": "--TStranche",
      "synonyms": "-tranche",
      "type": "List[Double]",
      "required": "no",
      "fulltext": "Add truth sensitivity slices through the call set at the given values. The default values are 100.0, 99.9, 99.0, and 90.0\n which will result in 4 estimated tranches in the final call set: the full set of calls (100% sensitivity at the accessible\n sites in the truth set), a 99.9% truth sensitivity tranche, along with progressively smaller tranches at 99% and 90%.",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "optional_param",
      "options": []
    },
    {
      "summary": "The names of the annotations which should used for calculations",
      "name": "--use_annotation",
      "synonyms": "-an",
      "type": "List[String]",
      "required": "yes",
      "fulltext": "See the input VCF file\u0027s INFO field for a list of all available annotations.",
      "defaultValue": "NA",
      "minValue": "NA",
      "maxValue": "NA",
      "minRecValue": "NA",
      "maxRecValue": "NA",
      "rodTypes": "NA",
      "kind": "required_param",
      "options": []
    }
  ],
  "refwindow": {},
  "description": "\n\n \u003cp\u003e\n This tool performs the first pass in a two-stage process called VQSR; the second pass is performed by the\n \u003ca href\u003d\u0027https://www.broadinstitute.org/gatk/guide/tooldocs/org_broadinstitute_gatk_tools_walkers_variantrecalibration_ApplyRecalibration.html\u0027\u003eApplyRecalibration\u003c/a\u003e tool.\n In brief, the first pass consists of creating a Gaussian mixture model by looking at the distribution of annotation\n values over a high quality subset of the input call set, and then scoring all input variants according to the model.\n The second pass consists of filtering variants based on score cutoffs identified in the first pass.\n\u003c/p\u003e\n\n \u003cp\u003e\n The purpose of the variant recalibrator is to assign a well-calibrated probability to each variant call in a call set.\n You can then create highly accurate call sets by filtering based on this single estimate for the accuracy of each call.\n The approach taken by variant quality score recalibration is to develop a continuous, covarying estimate of the relationship\n between SNP call annotations (such as QD, MQ, and ReadPosRankSum, for example) and the probability that a SNP is a true genetic\n variant versus a sequencing or data processing artifact. This model is determined adaptively based on \"true sites\" provided\n as input, typically HapMap 3 sites and those sites found to be polymorphic on the Omni 2.5M SNP chip array (in humans). This adaptive\n error model can then be applied to both known and novel variation discovered in the call set of interest to evaluate the\n probability that each call is real. The score that gets added to the INFO field of each variant is called the VQSLOD. It is\n the log odds of being a true variant versus being false under the trained Gaussian mixture model.\n \u003c/p\u003e\n\n \u003cp\u003eVQSR is probably the hardest part of the Best Practices to get right, so be sure to read the\n \u003ca href\u003d\u0027https://www.broadinstitute.org/gatk/guide/article?id\u003d39\u0027\u003emethod documentation\u003c/a\u003e,\n \u003ca href\u003d\u0027https://www.broadinstitute.org/gatk/guide/article?id\u003d1259\u0027\u003eparameter recommendations\u003c/a\u003e and\n \u003ca href\u003d\u0027https://www.broadinstitute.org/gatk/guide/article?id\u003d2805\u0027\u003etutorial\u003c/a\u003e to really understand what these\n tools and how to use them for best results on your own data.\u003c/p\u003e\n\n \u003ch3\u003eInputs\u003c/h3\u003e\n \u003cul\u003e\n \u003cli\u003eThe input raw variants to be recalibrated.\u003c/li\u003e\n \u003cli\u003eKnown, truth, and training sets to be used by the algorithm. See the method documentation for more details.\u003c/li\u003e\n \u003c/ul\u003e\n\n \u003ch3\u003eOutput\u003c/h3\u003e\n \u003cul\u003e\n \u003cli\u003eA recalibration table file that will be used by the ApplyRecalibration tool.\u003c/li\u003e\n \u003cli\u003eA tranches file which shows various metrics of the recalibration callset for slices of the data.\u003c/li\u003e\n \u003c/ul\u003e\n\n \u003ch3\u003eUsage example\u003c/h3\u003e\n \u003cp\u003eRecalibrating SNPs in exome data:\u003c/p\u003e\n \u003cpre\u003e\n java -Xmx4g -jar GenomeAnalysisTK.jar \\\n   -T VariantRecalibrator \\\n   -R reference.fasta \\\n   -input raw_variants.vcf \\\n   -resource:hapmap,known\u003dfalse,training\u003dtrue,truth\u003dtrue,prior\u003d15.0 hapmap_3.3.b37.sites.vcf \\\n   -resource:omni,known\u003dfalse,training\u003dtrue,truth\u003dfalse,prior\u003d12.0 1000G_omni2.5.b37.sites.vcf \\\n   -resource:1000G,known\u003dfalse,training\u003dtrue,truth\u003dfalse,prior\u003d10.0 1000G_phase1.snps.high_confidence.vcf\n   -resource:dbsnp,known\u003dtrue,training\u003dfalse,truth\u003dfalse,prior\u003d6.0 dbsnp_135.b37.vcf \\\n   -an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an InbreedingCoeff \\\n   -mode SNP \\\n   -recalFile output.recal \\\n   -tranchesFile output.tranches \\\n   -rscriptFile output.plots.R\n \u003c/pre\u003e\n\n \u003ch3\u003eCaveats\u003c/h3\u003e\n\n \u003cul\u003e\n \u003cli\u003eSNPs and indels must be recalibrated in separate runs (but it is not necessary to separate them into different files). Mixed records are treated as indels.\u003c/li\u003e\n \u003cli\u003eThe values used in the example above are only meant to show how the command lines are composed.\n They are not meant to be taken as specific recommendations of values to use in your own work, and they may be\n different from the values cited elsewhere in our documentation. For the latest and greatest recommendations on\n how to set parameter values for you own analyses, please read the Best Practices section of the documentation,\n especially the \u003ca href\u003d\u0027https://www.broadinstitute.org/gatk/guide/article?id\u003d1259\u0027\u003eFAQ document\u003c/a\u003e on VQSR parameters.\u003c/li\u003e\n \u003cli\u003eWhole genomes and exomes take slightly different parameters, so make sure you adapt your commands accordingly! See the documents linked above for details.\u003c/li\u003e\n \u003cli\u003eIf you work with small datasets (e.g. targeted capture experiments or small number of exomes), you will run into problems. Read the docs linked above for advice on how to deal with those issues.\u003c/li\u003e\n \u003cli\u003eIn order to create the model reporting plots Rscript needs to be in your environment PATH (this is the scripting version of R, not the interactive version).\n See \u003ca target\u003d\"r-project\" href\u003d\"http://www.r-project.org\"\u003ehttp://www.r-project.org\u003c/a\u003e for more info on how to download and install R.\u003c/li\u003e\n \u003c/ul\u003e",
  "name": "VariantRecalibrator",
  "annotinfo": "",
  "readfilters": [
    {
      "filename": "org_broadinstitute_gatk_engine_filters_MalformedReadFilter.html",
      "name": "MalformedReadFilter"
    },
    {
      "filename": "org_broadinstitute_gatk_engine_filters_BadCigarFilter.html",
      "name": "BadCigarFilter"
    },
    {
      "filename": "org_broadinstitute_gatk_engine_filters_UnmappedReadFilter.html",
      "name": "UnmappedReadFilter"
    },
    {
      "filename": "org_broadinstitute_gatk_engine_filters_NotPrimaryAlignmentFilter.html",
      "name": "NotPrimaryAlignmentFilter"
    },
    {
      "filename": "org_broadinstitute_gatk_engine_filters_FailsVendorQualityCheckFilter.html",
      "name": "FailsVendorQualityCheckFilter"
    },
    {
      "filename": "org_broadinstitute_gatk_engine_filters_DuplicateReadFilter.html",
      "name": "DuplicateReadFilter"
    }
  ],
  "downsampling": {},
  "group": "Variant Discovery Tools",
  "annotfield": ""
}